<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>nzilbb.labbcat for R • nzilbb.labbcat</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="nzilbb.labbcat for R">
<meta property="og:description" content="R package provides for querying and extracting data from LaBB-CAT">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@labbcat">
<meta name="twitter:site" content="@labbcat">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">nzilbb.labbcat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6-3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/examples/search-labels-alignments-praat-script.html">Search, Annotation, and Praat Script Example</a>
    </li>
    <li>
      <a href="articles/examples/search-labels-alignments-r-script.html">Search, Annotation, and R Script Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nzilbb/labbcat-R/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="nzilbblabbcat-package-for-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#nzilbblabbcat-package-for-r" class="anchor"></a>nzilbb.labbcat package for R</h1></div>
<p>This R package provides functionality for querying and extracting data from <a href="https://labbcat.canterbury.ac.nz/">LaBB-CAT</a> servers, directly from R.</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nzilbb.labbcat</span>)
<span class="no">labbcat.url</span> <span class="kw">&lt;-</span> <span class="st">"http://localhost:8080/labbcat/"</span>

<span class="co"># search for tokens of the KIT vowel</span>
<span class="no">m</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatches.html">getMatches</a></span>(<span class="no">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">segments</span><span class="kw">=</span><span class="st">"I"</span>))

<span class="co"># extract F1, 2, and 3 from the mid-point of each vowel</span>
<span class="no">f123</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/processWithPraat.html">processWithPraat</a></span>(
    <span class="no">labbcat.url</span>,
    <span class="no">m</span>$<span class="no">MatchId</span>,
    <span class="no">m</span>$<span class="no">Target.segments.start</span>,
    <span class="no">m</span>$<span class="no">Target.segments.end</span>,
    <span class="fu"><a href="reference/praatScriptFormants.html">praatScriptFormants</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>)),
    <span class="kw">window.offset</span><span class="kw">=</span><span class="fl">0.5</span>)</pre></div>
<p>LaBB-CAT is a web-based linguistic annotation store that stores audio or video recordings, text transcripts, and other annotations.</p>
<p>This package provides access to basic corpus structure data, pattern-based search, annotation, audio, TextGrid (and other format) extraction, and server-side acoustic measurement with Praat.</p>
<p>Online documentation is available at <a href="https://nzilbb.github.io/labbcat-R" class="uri">https://nzilbb.github.io/labbcat-R</a></p>
<div id="basic-usage-instructions" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage-instructions" class="anchor"></a>Basic usage instructions</h2>
<div id="getting-started" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h3>
<p>To install the latest version of the package in CRAN:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"nzilbb.labbcat"</span>)</pre></div>
<p>To use it:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nzilbb.labbcat</span>)</pre></div>
<p>For all functions, the first parameter is the URL to the LaBB-CAT instance you want to interact with - e.g. “<a href="https://labbcat.canterbury.ac.nz/demo/" class="uri">https://labbcat.canterbury.ac.nz/demo/</a>”.</p>
<p>If the instance is password-protected, you’ll be prompted for the username and password the first time you invoke a function for that instance.</p>
</div>
<div id="basic-informational-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-informational-functions" class="anchor"></a>Basic informational functions</h3>
<p>There are some basic functions that provide information about the LaBB-CAT instance you’re using.</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">labbcat.url</span> <span class="kw">&lt;-</span> <span class="st">"https://labbcat.canterbury.ac.nz/demo"</span>

<span class="no">id</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getId.html">getId</a></span>(<span class="no">labbcat.url</span>)
<span class="no">layers</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getLayerIds.html">getLayerIds</a></span>(<span class="no">labbcat.url</span>)
<span class="no">corpora</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getCorpusIds.html">getCorpusIds</a></span>(<span class="no">labbcat.url</span>)

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"LaBB-CAT instance"</span>, <span class="no">id</span>, <span class="st">"has"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">layers</span>), <span class="st">"layers. The corpora are:"</span>)
<span class="no">corpora</span></pre></div>
</div>
<div id="accessing-specific-transcript-and-participant-ids" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-specific-transcript-and-participant-ids" class="anchor"></a>Accessing specific transcript and participant IDs</h3>
<p>Transcripts are called ‘graphs’ because each one is represented as an ‘Annotation Graph’ (see Bird &amp; Liberman 2001)</p>
<p>You can get a complete list of participants and transcripts:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">participants</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getParticipantIds.html">getParticipantIds</a></span>(<span class="no">labbcat.url</span>)
<span class="no">transcripts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getGraphIds.html">getGraphIds</a></span>(<span class="no">labbcat.url</span>)

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"There are"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">participants</span>), <span class="st">"participants. The first one is"</span>, <span class="no">participants</span>[<span class="fl">1</span>])
<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"There are"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">transcripts</span>), <span class="st">"transcripts. The first one is"</span>, <span class="no">transcripts</span>[<span class="fl">1</span>])</pre></div>
<p>There are also ways to get a filtered list of transcripts:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="co">## Transcripts in the UC corpus:</span>
<span class="fu"><a href="reference/getGraphIdsInCorpus.html">getGraphIdsInCorpus</a></span>(<span class="no">labbcat.url</span>, <span class="st">"UC"</span>)

<span class="co">## Transcripts featuring the participant QB1602:</span>
<span class="fu"><a href="reference/getGraphIdsWithParticipant.html">getGraphIdsWithParticipant</a></span>(<span class="no">labbcat.url</span>, <span class="st">"QB1602"</span>)

<span class="co">## Transcripts with 'YW' in their name:</span>
<span class="fu"><a href="reference/getMatchingGraphIds.html">getMatchingGraphIds</a></span>(<span class="no">labbcat.url</span>, <span class="st">"id MATCHES '.*YW.*'"</span>)</pre></div>
</div>
<div id="accessing-media" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-media" class="anchor"></a>Accessing Media</h3>
<p>Given a graph ID (i.e. a transcript name) you can access information about what media it has available:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="co">## Default WAV URL:</span>
<span class="fu"><a href="reference/getMedia.html">getMedia</a></span>(<span class="no">labbcat.url</span>, <span class="st">"AP2515_ErrolHitt.eaf"</span>)

<span class="no">media</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getAvailableMedia.html">getAvailableMedia</a></span>(<span class="no">labbcat.url</span>, <span class="st">"AP2515_ErrolHitt.eaf"</span>)

<span class="co">## All media file names</span>
<span class="no">media</span>$<span class="no">name</span>

<span class="co">## Their URLs</span>
<span class="no">media</span>$<span class="no">url</span></pre></div>
<p>Once you’ve got a URL, you can save its contents using the <em>httr</em> package, something like this:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"httr"</span>)

<span class="no">wav.file</span> <span class="kw">&lt;-</span> <span class="no">media</span>$<span class="no">name</span>[<span class="fl">1</span>]
<span class="no">wav.url</span> <span class="kw">&lt;-</span> <span class="no">media</span>$<span class="no">url</span>[<span class="fl">1</span>]

<span class="no">response</span> <span class="kw">&lt;-</span> <span class="kw pkg">httr</span><span class="kw ns">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span>(<span class="no">wav.url</span>, <span class="no">labbcat</span>$<span class="no">authorization</span>, <span class="kw pkg">httr</span><span class="kw ns">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/write_disk.html">write_disk</a></span>(<span class="no">wav.file</span>, <span class="kw">overwrite</span><span class="kw">=</span><span class="fl">TRUE</span>), <span class="kw pkg">httr</span><span class="kw ns">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/progress.html">progress</a></span>())
<span class="kw">if</span> (<span class="kw pkg">httr</span><span class="kw ns">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/status_code.html">status_code</a></span>(<span class="no">response</span>) <span class="kw">!=</span> <span class="fl">200</span>) { <span class="co"># 200 means OK</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Downloading"</span>, <span class="no">wav.file</span>, <span class="st">"failed:"</span>, <span class="kw pkg">httr</span><span class="kw ns">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/http_status.html">http_status</a></span>(<span class="no">response</span>)$<span class="no">message</span>))
} <span class="kw">else</span> {
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Downloading"</span>, <span class="no">wav.file</span>, <span class="st">"worked!"</span>))

  <span class="co">## Tidily delete the file we just downloaded</span>
  <span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span>(<span class="no">wav.file</span>)
}</pre></div>
</div>
<div id="media-fragments" class="section level3">
<h3 class="hasAnchor">
<a href="#media-fragments" class="anchor"></a>Media fragments</h3>
<p>You can access a selected fragment of a wav file with <code>getSoundFragments</code>. The function downloads a wav file to the current working directory, and returns the name of the file:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="no">wav.file</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getSoundFragments.html">getSoundFragments</a></span>(<span class="no">labbcat.url</span>, <span class="st">"AP2505_Nelson.eaf"</span>, <span class="fl">10.0</span>, <span class="fl">15.0</span>)

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"The third 5 seconds is in this file:"</span>, <span class="no">wav.file</span>)

<span class="co">## tidily delete the file we just downloaded</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span>(<span class="no">wav.file</span>)</pre></div>
<p><code>getSoundFragments</code> also accepts vectors for the <code>id</code>, <code>start</code>, and <code>end</code> parameters:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">id</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AP2505_Nelson.eaf"</span>, <span class="st">"AP2512_MattBlack.eaf"</span>, <span class="st">"AP2512_MattBlack.eaf"</span>),
  <span class="kw">start</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">10.0</span>, <span class="fl">20.0</span>, <span class="fl">30.0</span>),
  <span class="kw">end</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">15.0</span>, <span class="fl">25.0</span>, <span class="fl">35.0</span>))

<span class="no">wav.files</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getSoundFragments.html">getSoundFragments</a></span>(<span class="no">labbcat.url</span>, <span class="no">results</span>$<span class="no">id</span>, <span class="no">results</span>$<span class="no">start</span>, <span class="no">results</span>$<span class="no">end</span>, <span class="kw">no.progress</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="no">wav.files</span>

<span class="co">## tidily delete the files we just downloaded</span>
<span class="fu"><a href="https://rdrr.io/r/base/files.html">file.remove</a></span>(<span class="no">wav.files</span>)</pre></div>
<p>This means that, if you have a results csv file exported from LaBB-CAT, which identifies segment tokens, you can iterate through the rows, downloading the corresponding wav files, something like:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="co">## load the results from the CSV file</span>
<span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"results.csv"</span>, <span class="kw">header</span><span class="kw">=</span><span class="no">T</span>)

<span class="co">## download all the segment WAV files</span>
<span class="no">wav.files</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getSoundFragments.html">getSoundFragments</a></span>(
    <span class="no">labbcat</span>, <span class="no">results</span>$<span class="no">Transcript</span>, <span class="no">results</span>$<span class="no">segments.start</span>, <span class="no">results</span>$<span class="no">segments.end</span>)</pre></div>
</div>
<div id="getting-annotations-from-other-layers" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-annotations-from-other-layers" class="anchor"></a>Getting annotations from other layers</h3>
<p>If you have search results in a CSV file, and would like to retrieve annotations from some other layer, you can use the <code>getMatchLabels</code> function, providing the <em>MatchId</em> column (or the <em>URL</em> column) that indentifies the token, and the desired layer name:</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"results.csv"</span>, <span class="kw">header</span><span class="kw">=</span><span class="no">T</span>)
<span class="no">phonemes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatchLabels.html">getMatchLabels</a></span>(<span class="no">labbcat.url</span>, <span class="no">results</span>$<span class="no">MatchId</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"participant_age"</span>, <span class="st">"phonemes"</span>))</pre></div>
<p>If you want alignment information - i.e. start and end time – you can use <code>getMatchAlignments</code>:</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="st">"results.csv"</span>, <span class="kw">header</span><span class="kw">=</span><span class="no">T</span>)
<span class="no">phonemes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatchAlignments.html">getMatchAlignments</a></span>(<span class="no">labbcat.url</span>, <span class="no">results</span>$<span class="no">MatchId</span>, <span class="st">"syllables"</span>)</pre></div>
</div>
<div id="search" class="section level3">
<h3 class="hasAnchor">
<a href="#search" class="anchor"></a>Search</h3>
<p>Searching for matching tokens can be achieved using the <code>getMatches</code> function.</p>
<p>A basic search can be achieved with a simple, single-layer pattern like:</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="co"># all words starting with "ps..."</span>
<span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatches.html">getMatches</a></span>(<span class="no">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">orthography</span> <span class="kw">=</span> <span class="st">"ps.*"</span>))</pre></div>
<p>More complex patterns, across multiple tokens an multiple layers, is possible by specifying a more complex structure:</p>
<div class="sourceCode" id="cb15"><pre class="r"><span class="co"># the word 'the' followed immediately or with one intervening word by</span>
<span class="co"># a hapax legomenon (word with a frequency of 1) that doesn't start with a vowel</span>
<span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatches.html">getMatches</a></span>(<span class="no">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">columns</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">layers</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">orthography</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"the"</span>)),
          <span class="kw">adj</span> <span class="kw">=</span> <span class="fl">2</span>),
     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">layers</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
            <span class="kw">phonemes</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">not</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"[cCEFHiIPqQuUV0123456789~#\\{\\$@].*"</span>),
            <span class="kw">frequency</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">max</span> <span class="kw">=</span> <span class="st">"2"</span>))))))</pre></div>
<p>The data frame that’s returned contains columns that can be used as parameters for other functions:</p>
<div class="sourceCode" id="cb16"><pre class="r"><span class="co"># get all instances of the KIT vowel</span>
<span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatches.html">getMatches</a></span>(<span class="no">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">segments</span> <span class="kw">=</span> <span class="st">"I"</span>))

<span class="co"># get phonemic transcription for the whole word</span>
<span class="no">phonemes</span>  <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatchLabels.html">getMatchLabels</a></span>(<span class="no">labbcat.url</span>, <span class="no">results</span>$<span class="no">MatchId</span>, <span class="st">"phonemes"</span>)

<span class="co"># download all the segment WAV files</span>
<span class="no">wav.files</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getSoundFragments.html">getSoundFragments</a></span>(
    <span class="no">labbcat.url</span>, <span class="no">results</span>$<span class="no">Transcript</span>, <span class="no">results</span>$<span class="no">Target.segments.start</span>, <span class="no">results</span>$<span class="no">Target.segments.end</span>)</pre></div>
</div>
<div id="looking-up-dictionaries" class="section level3">
<h3 class="hasAnchor">
<a href="#looking-up-dictionaries" class="anchor"></a>Looking up dictionaries</h3>
<p>LaBB-CAT maintains a number of <a href="https://labbcat.canterbury.ac.nz/demo/dictionaries">dictionaries</a> it uses to look things up. These include access to CELEX, LIWC, and other lexicons that might be set up in the LaBB-CAT instance.</p>
<p>You can list the available dictionaries using:</p>
<div class="sourceCode" id="cb17"><pre class="r"><span class="no">dictionaries</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getDictionaries.html">getDictionaries</a></span>(<span class="no">labbcat.url</span>)</pre></div>
<p>With one of the returned layer manager ID and dictionary ID pairs, you can look up dictionary entries for a list of keys:</p>
<div class="sourceCode" id="cb18"><pre class="r"><span class="no">words</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"the"</span>, <span class="st">"quick"</span>, <span class="st">"brown"</span>, <span class="st">"fox"</span>)
<span class="no">pronunciation</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getDictionaryEntries.html">getDictionaryEntries</a></span>(<span class="no">labbcat.url</span>, <span class="st">"CELEX-EN"</span>, <span class="st">"Phonology (wordform)"</span>, <span class="no">words</span>)</pre></div>
</div>
<div id="process-with-praat" class="section level3">
<h3 class="hasAnchor">
<a href="#process-with-praat" class="anchor"></a>Process with Praat</h3>
<p>This function instructs the LaBB-CAT server to invoke Praat for a set of sound intervals, in order to extract acoustic measures.</p>
<p>The exact measurements to return depend on the <code>praat.script</code> that is invoked. This is a Praat script fragment that will run once for each sound interval specified.</p>
<p>There are functions to allow the generation of a number of pre-defined praat scripts for common tasks such as formant, pitch, intensity, and centre of gravity:</p>
<div class="sourceCode" id="cb19"><pre class="r"><span class="co"># Perform a search</span>
<span class="no">results</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getMatches.html">getMatches</a></span>(<span class="no">labbcat.url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">segments</span><span class="kw">=</span><span class="st">"I"</span>))

<span class="co"># get F1 and F2 for the mid point of the vowel</span>
<span class="no">formants</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/processWithPraat.html">processWithPraat</a></span>(
       <span class="no">labbcat.url</span>,
       <span class="no">results</span>$<span class="no">MatchId</span>, <span class="no">results</span>$<span class="no">Target.segments.start</span>, <span class="no">results</span>$<span class="no">Target.segments.end</span>,
       <span class="fu"><a href="reference/praatScriptFormants.html">praatScriptFormants</a></span>(),
       <span class="kw">no.progress</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></div>
<p>You can provide your own script, either by building a string with your code, or loading one from a file.</p>
<div class="sourceCode" id="cb20"><pre class="r"><span class="co"># execute a custom script loaded form a file</span>
<span class="no">acoustic.measurements</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/processWithPraat.html">processWithPraat</a></span>(
       <span class="no">labbcat.url</span>,
       <span class="no">results</span>$<span class="no">MatchId</span>, <span class="no">results</span>$<span class="no">Target.segments.start</span>, <span class="no">results</span>$<span class="no">Target.segments.end</span>,
       <span class="fu"><a href="https://rdrr.io/r/base/readLines.html">readLines</a></span>(<span class="st">"acousticMeasurements.praat"</span>))</pre></div>
</div>
<div id="retrieving-transcript-and-participant-attributes" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieving-transcript-and-participant-attributes" class="anchor"></a>Retrieving transcript and participant attributes</h3>
<p>Transcript attributes can be retrieved like this:</p>
<div class="sourceCode" id="cb21"><pre class="r"><span class="co"># Get language, duration, and corpus for transcripts starting with 'BR'</span>
<span class="no">attributes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getTranscriptAttributes.html">getTranscriptAttributes</a></span>(<span class="no">labbcat.url</span>,
            <span class="fu"><a href="reference/getMatchingTranscriptIds.html">getMatchingTranscriptIds</a></span>(<span class="no">labbcat.url</span>, <span class="st">"id MATCHES 'BR.+'"</span>),
            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'transcript_language'</span>, <span class="st">'transcript_duration'</span>, <span class="st">'corpus'</span>))</pre></div>
<p>Similarly, participant attributes can also be accessed:</p>
<div class="sourceCode" id="cb22"><pre class="r"><span class="co"># Get gender and age for all participants</span>
<span class="no">attributes</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/getParticipantAttributes.html">getParticipantAttributes</a></span>(<span class="no">labbcat.url</span>,
            <span class="fu"><a href="reference/getParticipantIds.html">getParticipantIds</a></span>(<span class="no">labbcat.url</span>),
            <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'participant_gender'</span>, <span class="st">'participant_age'</span>))</pre></div>
</div>
</div>
</div>
<div id="developers" class="section level1">
<h1 class="hasAnchor">
<a href="#developers" class="anchor"></a>Developers</h1>
<div id="prerequesites" class="section level2">
<h2 class="hasAnchor">
<a href="#prerequesites" class="anchor"></a>Prerequesites</h2>
<p>For building the documentation with pkgdown:</p>
<pre><code>apt install pandoc
R -e "install.packages("pkgdown")"</code></pre>
</div>
<div id="building-the-package-and-documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#building-the-package-and-documentation" class="anchor"></a>Building the package and documentation</h2>
<p>The package can be built from the source code using using:</p>
<pre><code>./build.sh</code></pre>
</div>
<div id="running-automated-tests" class="section level2">
<h2 class="hasAnchor">
<a href="#running-automated-tests" class="anchor"></a>Running automated tests</h2>
<p>Unit tests use the ‘testthat’ package, which requires a one-time installation:</p>
<pre><code>R -e "install.packages('testthat')"</code></pre>
<p>After ‘testthat’ is installed, you can use the following commands to run unit tests:</p>
<p><code>R -e "devtools::test('nzilbb.labbcat')"</code>x</p>
<p>Specific tests can be run like this:</p>
<pre><code>R -e "devtools::test('nzilbb.labbcat', filter='getId')"</code></pre>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=nzilbb.labbcat">https://​cloud.r-project.org/​package=nzilbb.labbcat</a>
</li>
<li>Browse source code at <br><a href="https://github.com/nzilbb/labbcat-R/">https://​github.com/​nzilbb/​labbcat-R/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.canterbury.ac.nz/nzilbb/">Robert Fromont</a> <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.canterbury.ac.nz/nzilbb/">Robert Fromont</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
